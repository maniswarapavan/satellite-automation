---
- name: Fetching Name list of existing Activation Keys
  shell: hammer --output cve activation-key list --organization {{ORG}} |grep Name
  register: activation_key_list

- name: Creating fact from Name list of existing Activation Keys
  set_fact:
    activation_key_exist:
  loop: "{{activation_key_list}}"
  loop: 
- name: Creating Activiation Key
  shell:  hammer activation-key create 
      --organization "{{ORG}}"
      --name "{{ACTIVATION_KEY_NAME}}"
      --content-view "{{CONTENT_VIEW_NAME}}"
      --lifecycle-environment "{{LIFE_CYCLE_ENV_NAME}}"
  tags:
    - satellite_configuration
    - activationkey

- name: Adding subscription to Activiation Key
  shell:  hammer activation-key add-subscription
      --organization "{{ORG}}"
      --name "{{ACTIVATION_KEY_NAME}}"
      --subscription-id 1
  tags:
    - satellite_configuration
    - activationkey
